#include "websploit.h"

exploit::exploit(string n, string tp, string e, string ue, string st, string et, string nst, string net, string d) {
	name = n;
	toPass = tp;
	expected = e;
	unexpected = ue;
	s_tag = st;
	e_tag = et;
	n_s_tag = nst;
	n_e_tag = net;
	desc = d;
}

bool testExploit(exploit e, string url, string param) {
	string res = request(url, param, e.toPass);
	if (!contains(res, e.expected)) {
		return 0;
	}
	if (e.unexpected != "ns" && contains(res, e.unexpected)) {
		return 0;
	}
	if (e.s_tag != "ns" && !inTags(res, e.expected, e.s_tag, e.e_tag)) {
		return 0;
	}
	if (e.n_s_tag != "ns") {
		return !(inTags(res, e.expected, e.n_s_tag, e.n_e_tag));
	}
	return 1;
}